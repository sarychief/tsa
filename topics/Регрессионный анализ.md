

Алгоритм:

- [Выбираем](https://www.notion.so/2-1-f094744562bf4e9085971e2ae6a47266?pvs=21) форму тренда
- [Выбираем](https://www.notion.so/2-1-f094744562bf4e9085971e2ae6a47266?pvs=21) порядок регрессионной модели
- [Строим](https://www.notion.so/2-1-f094744562bf4e9085971e2ae6a47266?pvs=21) уравнение регрессии
- [Решаем](https://www.notion.so/2-1-f094744562bf4e9085971e2ae6a47266?pvs=21) по методу наименьших квадратов

**Формы тренда:**

- Линейный: $\large \tau(t) = \beta_0 + \beta_1t$
- Квадратичный: $\large \tau(t) = \beta_0 + \beta_1t + \beta_2t^2$
- Полиномиальный: $\large \tau(t) = \beta_0 + \beta_1t + ... + \beta_pt^p$
- Экспоненциальный: $\large \tau(t) = \beta_0e^{\beta_1t}$
- Логистический: $\large\tau(t) = \frac{1}{1 + \beta_1e^{-\beta_2t}}$

**Определяем степень полинома, когда выбрали вид модели:**

- Вычисляем разности ($k \le 5$):
    
    Разность 1-го порядка: $\Delta_i = y_i - y_{i-1}$
    
    Разность 2-го порядка: $\Delta^{(2)}_i = \Delta_i - \Delta_{i-1}$
    
    $...$
    
    Разность $k$-го порядка: $\Delta^{(k)}_i = \Delta^{(k-1)}_i - \Delta^{(k-1)}_{i-1}$
    
- Для каждого порядка ищем: $\Large d_k = \frac{\frac{1}{N-k}\sum^{N-k}_{i=1}(\Delta^{(k)}_i)^2}{C^k_{2k}},\ \ C^k_{2k} = \frac{(2k)!}{(k!)^2}$
    
    - сумма квадратов разности на комбинации
    - Сначала величина $d_k$ первоначально убывает с ростом $k$, а затем стабилизируется на одном уровне
- В итоге выбирается степень полинома равной $p=k_0 - 1$
    

**На основании вида и степени полинома регрессии строим уравнение.**

Обобщенный МНК: $\large\sum^N_{i=1}(\tau(t_i)-y_i)^2 \rightarrow \min$
![[Untitled1.png]]
